project:
  target_language: en
  languages:
    en:
      master_prompt: prompts/master_prompt_en_compressed.xml
      prompts:
        romcom: prompts/master_prompt_en_compressed.xml
        fantasy: prompts/master_prompt_fantasy_en.xml
      modules_dir: modules/
      grammar_rag:
        enabled: true
        config_file: config/english_grammar_rag_compressed.json  # Optimized: 154KB (was 283KB)
        inject_mode: always
        max_patterns_per_prompt: 8
        vector_store:
          persist_directory: ./chroma_english_patterns
          collection_name: english_grammar_patterns
      output_suffix: _EN
      language_code: en
      language_name: English
      ui_strings:
        toc_title: Table of Contents
        cover_title: Cover
        start_content: Start of Content
    vn:
      master_prompt: VN/master_prompt_vn_pipeline.xml
      prompts:
        romcom: VN/master_prompt_vn_pipeline.xml
        fantasy: VN/master_prompt_vn_pipeline.xml
      modules_dir: VN/modules/
      modules:
      - MEGA_CORE_TRANSLATION_ENGINE_VN.md
      - MEGA_CHARACTER_VOICE_SYSTEM_VN.md
      - ANTI_TRANSLATIONESE_MODULE_VN.md
      reference_dir: VN/Reference/
      reference_modules:
      - Library_LOCALIZATION_PRIMER_VN.md
      - Library_REFERENCE_ICL_SAMPLES.md
      - Ref_ONOMATOPOEIA_PROTOCOL_v1.0.md
      grammar_rag:
        enabled: true
        config_file: VN/vietnamese_grammar_rag.json
        inject_mode: always
        max_patterns_per_prompt: 10
      output_suffix: _VN
      language_code: vi
      language_name: Vietnamese
      ui_strings:
        toc_title: Mục Lục
        cover_title: Bìa
        start_content: Bắt Đầu
gemini:
  model: gemini-2.5-pro
  fallback_model: gemini-2.5-flash
  generation:
    temperature: 1.0
    top_p: 0.95
    top_k: 40
    max_output_tokens: 65535
    qc_temperature: 0.3
  thinking_mode:
    enabled: true
    thinking_budget: 32768
    save_to_file: true
    output_dir: THINKING
  safety:
    harassment: BLOCK_NONE
    hate_speech: BLOCK_NONE
    sexually_explicit: BLOCK_NONE
    dangerous_content: BLOCK_NONE
    fallback:
      enabled: true
      max_retries: 3
      bridge_words: 200
      temperature_boost: 0.15
      revert_on_success: true
      triggers:
      - SAFETY
      - RECITATION
      - BLOCKED
  rate_limit:
    requests_per_minute: 2
    retry_attempts: 10
    retry_delay_seconds: 5
  caching:
    enabled: true
    ttl_minutes: 120
kimi:
  web_url: https://kimi.com
  validation:
    enabled: true
    auto_mark_character_names: true
    auto_mark_locations: true
    auto_mark_organizations: true
    auto_mark_special_terms: true
    confidence_threshold: medium
    cache_file: WORK/.kimi_validation_cache.json
    cache_ttl_hours: 168
translation:
  enable_multimodal: true
  enable_self_healing_anti_ai_ism: false
  quality:
    contraction_rate_min: 0.95
    contraction_rate_gold: 0.99
    max_ai_isms_per_chapter: 5
  contraction_rules:
    casual_introspective:
      required_rate: 0.995
      critical_forms:
      - it is -> it's
      - that is -> that's
      - there is -> there's
      - do not -> don't
      - does not -> doesn't
      high_priority:
      - was not -> wasn't
      - were not -> weren't
      - could not -> couldn't
      - should not -> shouldn't
      - would not -> wouldn't
    formal_polite:
      required_rate: 0.85
      exceptions:
      - emphasis
      - philosophical_discourse
      - character_defined_formal
    internal_monologue:
      required_rate: 0.99
      perfect_tense:
      - would have -> would've
      - could have -> could've
      - should have -> should've
  context:
    lookback_chapters: 2
    enforce_name_consistency: true
  massive_chapter:
    enable_smart_chunking: false
    chunk_threshold_chars: 60000
    chunk_threshold_bytes: 120000
    enable_volume_cache: true
critics:
  qc_rubric: prompts/qc_rubric.md
  auto_fix:
    enabled: true
    contractions: true
    punctuation: true
  thresholds:
    pass_min_score: 0.85
    revise_min_score: 0.7
  ai_ism_patterns:
  - indeed
  - quite
  - rather
  - I shall
  - most certainly
  - if you will
  - as it were
  - one might say
builder:
  epub_version: '3.0'
  css_template: templates/styles/main.css
  fonts:
    enabled: true
    directory: templates/fonts/
  images:
    cover_max_width: 1600
    illustration_max_width: 1200
    quality: 85
directories:
  input: INPUT/
  work: WORK/
  output: OUTPUT/
  prompts: prompts/
  modules: modules/
  templates: templates/
  bibles: bibles/
bibles:
  enabled: true
  auto_resolve: true
  inject_in_prompt: true
multimodal:
  enabled: true
  models:
    vision: gemini-3-pro-preview
    prose: gemini-2.5-pro
  visual_cache:
    enabled: true
    path: visual_cache.json
    invalidation:
      on_model_upgrade: true
      on_prompt_change: true
      on_image_change: true
      max_age_days: 90
      respect_manual_override: true
  safety:
    fallback_on_block: true
    log_blocked_images: true
  thinking:
    enabled: true
    default_level: HIGH
    high_triggers:
    - emotional_climax
    - character_introduction
    - plot_revelation
  lookahead:
    enabled: true
    buffer_size: 3
  strict_prompt: true
  thought_storage:
    enabled: true
    path: cache/thoughts
pre_toc_detection:
  enabled: false
  min_text_length: 50
  min_sentences_after_credits: 2
  dialog_markers:
  - 「
  - 」
  - '"'
  - '"'
  pronouns:
  - 俺
  - 私
  - 僕
  - わたし
  - I
  credit_markers:
  - イラスト
  - 著者
  - 発行
  - 印刷
  - 装丁
  - デザイン
  - Illustration
  - Author
  - Published
  - Printed
  exclude_patterns:
  - fmatter
  - kuchie
  - cover
  - titlepage
  - caution
  chapter_title: Opening
logging:
  level: DEBUG
  format: '[%(levelname)s] %(asctime)s - %(name)s - %(message)s'
  file: pipeline.log
debug:
  save_raw_responses: true
  verbose_api: true
  dry_run: false
post_processing:
  format_normalizer:
    enabled: true
    aggressive: false
  cjk_cleaner:
    enabled: true
    strict_mode: false
    min_confidence: 0.7
    context_window: 5
    log_detections: true
cli:
  tui_default: true
  verbose_mode: true
  show_progress: true
  confirm_caching: true
  confirm_inheritance: true
  auto_proceed: false
